<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Student</title>
</head>

<body>
    <!DOCTYPE html>
    <html lang="en">
    <!-- Mirrored from learnplus.frontendmatter.com/instructor-dashboard.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 09 Jun 2018 08:40:12 GMT -->

    <head>
        {% load static %}
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <title>Instructor</title>

        <!-- Prevent the demo from appearing in search engines (REMOVE THIS) -->
        <meta name="robots" content="noindex" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

        <!-- Simplebar -->
        <link type="text/css" href="{% static 'assets/vendor/simplebar.css' %}" rel="stylesheet" />

        <!-- Material Design Icons  -->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

        <!-- Roboto Web Font -->
        <link href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en" rel="stylesheet" />

        <!-- MDK -->
        <link type="text/css" href="{% static 'assets/vendor/material-design-kit.css' %}" rel="stylesheet" />

        <!-- Sidebar Collapse -->
        <link type="text/css" href="{% static 'assets/vendor/sidebar-collapse.min.css' %}" rel="stylesheet" />

        <!-- App CSS -->
        <link type="text/css" href="{% static 'assets/css/style.css' %}" rel="stylesheet" />

        <!-- Vendor CSS -->
        <link rel="stylesheet" href="{% static 'assets/css/morris.css' %}" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.css" integrity="sha512-3pIirOrwegjM6erE5gPSwkUzO+3cTjpnV9lexlNZqvupR64iZBnOOTiiLPb9M36zpMScbmUNIcHUqKD47M719g==" crossorigin="anonymous" referrerpolicy="no-referrer"
        />
        <style>
            .warn {
                border: 2px solid rgb(214, 112, 112);
            }
            
            .correct {
                background-color: rgb(16, 224, 145);
                border-radius: 5px;
                padding: 10px;
            }
            
            .incorrect {
                background-color: rgb(233, 38, 38);
                border-radius: 5px;
                padding: 10px;
            }
        </style>
    </head>

    <body>
        <div class="d-flex flex-column h-100">
            <!-- Navbar -->
            <nav class="navbar navbar-expand navbar-dark bg-primary m-0">
                <!-- Toggle sidebar -->

                <!-- Brand -->
                <a href="/instructor/dashboard" class="navbar-brand"><i class="material-icons">school</i> Thi trắc nghiệm online</a
            >

            <div class="navbar-spacer"></div>

            <!-- Menu -->
            <ul class="nav navbar-nav d-none d-md-flex"></ul>

            <!-- Menu -->
            <ul class="nav navbar-nav">
              <!-- User dropdown -->
              <li class="nav-item dropdown">
                <a
                  class="nav-link active dropdown-toggle"
                  data-toggle="dropdown"
                  href="#"
                  role="button"
                  >Account</a>
                <div class="dropdown-menu dropdown-menu-right">
                    <a class="dropdown-item" href="/student/profile">
                        <i class="material-icons">person</i> Profile
                    </a>
                    <a class="dropdown-item" href="/student/history">
                        <i class="material-icons">book</i> History
                    </a>
                    <a class="dropdown-item" href="/login">
                        <i class="material-icons">lock</i> Logout
                    </a>
                </div>
                </li>
                <!-- // END User dropdown -->
                </ul>
            </nav>
            <!-- // END Navbar -->

            <div class="mdk-drawer-layout js-mdk-drawer-layout flex" data-fullbleed data-push data-has-scrolling-region>
                <div class="mdk-drawer-layout__content mdk-drawer-layout__content--scrollable">
                    <div class="container-fluid">
                        <div class="row" id="show_class"></div>
                        <h4 style="
                    text-align: center;
                    text-transform: uppercase;
                    margin-top: 24px;
                  " id="title_c"></h4>
                        <h6 style="text-align: center; text-transform: uppercase" id="desc_c"></h6>
                        <h3 style="text-align: center">
                            <span id="time" style="color: rgb(189, 11, 11)"></span>
                        </h3>
                        <h5 style="text-align: center; color: brown" id="alret"></h5>
                        <button class="btn btn-primary" style="text-transform: uppercase" id="start">
                  start quiz
                </button>
                    </div>
                    <hr style="font-weight: bold" />
                    <div class="container-fluid">
                        <div class="row" id="course_index" style="padding: 0px 100px 0px 100px;"></div>
                        <button class="btn btn-primary" style="margin-left: 85%;" id="submit">Sumit</button>
                    </div>
                </div>

            </div>
        </div>
        </div>
        </div>
        <!-- popup created class -->

        <!-- jQuery -->
        <script src="{% static 'assets/vendor/jquery.min.js' %}"></script>

        <!-- Bootstrap -->
        <script src="{% static 'assets/vendor/popper.min.js' %}"></script>
        <script src="{% static 'assets/vendor/bootstrap.min.js' %}"></script>

        <!-- Simplebar -->
        <!-- Used for adding a custom scrollbar to the drawer -->
        <script src="{% static 'assets/vendor/simplebar.js' %}"></script>

        <!-- MDK -->
        <script src="{% static 'assets/vendor/dom-factory.js' %}"></script>
        <script src="{% static 'assets/vendor/material-design-kit.js' %}"></script>

        <!-- Sidebar Collapse -->
        <script src="{% static 'assets/vendor/sidebar-collapse.js' %}"></script>

        <!-- App JS -->
        <script src="{% static 'assets/js/main.js' %}"></script>

        <!-- Theme Colors -->
        <script src="{% static 'assets/js/colors.js' %}"></script>

        <!-- Morris.js charts -->
        <script src="{% static 'assets/vendor/raphael.min.js' %}"></script>

        <!-- Moment.js -->
        <script src="{% static 'assets/vendor/moment.min.js' %}"></script>
        <script src="{% static 'assets/vendor/moment-range.min.js' %}"></script>
        <script src="{% static 'js/setCookies.js' %}"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js" integrity="sha512-VEd+nq25CkR676O+pLBnDW09R7VQX9Mdiij052gVCp5yVH3jGtH70Ho/UUv4mJDsEdTvqRCFZg0NKGiojGnUCw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

        <script>
            function load(id) {
                $.ajax({
                    type: "GET",
                    url: `http://localhost:8000/class/getOnly/${id}`,
                    success: (data) => {
                        const dataClass = data["theClass"];
                        $("#title_c").html(`Class Name: ${dataClass[0]["title"]}`);
                        $("#desc_c").html(
                            `Description about class: ${dataClass[0]["desc"]}`
                        );
                        console.log(dataClass);
                        const str = `
                <img src="../../../static/${dataClass[0]["img"]}" style="width:100%; height:300px; border-radius:10px;opacity: 0.7;" alt="">
           
                `;
                        $("#show_class").append(str);

                        dataClass[0]["course"].forEach((element) => {
                            $.ajax({
                                url: `http://localhost:8000/course/getOnly/${element["idcourse"]}`,
                                type: "GET",
                                success: (data) => {
                                    console.log(data);
                                    let str = `
                      <div class="col-3">
                                <div class="card">
                                    <img class="card-img-top" src="../../../static/${data["img"]}" style=" height:200px; " alt="Card image cap">
                                    <div class="card-body">
                                      <h5 class="card-title"> Course name: ${data["title"]}</h5>
                                      <p class="card-text">Description:${data["desc"]}</p>
                                      <small class="text-muted">Created: ${data["create_on"]}</small>
                                    </div>
                                    <div class="card-footer">
                                    <a href="http://localhost:8000/student/detail?course=${data["id"]}" class="btn btn-primary">Detail</a>
                                    
                                      
                                    </div>
                                  </div>
                            </div>
                      
                      
                      `;
                                    $("#course_index").append(str);
                                },
                                error: (data) => {
                                    console.error(data);
                                },
                            });
                        });
                    },
                    error: (data) => {
                        console.log(data);
                    },
                });
            }
            $(document).ready((e) => {
                $('#start').hide()
                let searchParams = new URLSearchParams(window.location.search);
                let idclass = searchParams.get("class");
                if (searchParams.get("class") !== null) {
                    load(idclass);
                    $("#submit").hide();
                } else {
                    console.log("null class");
                }
                if (searchParams.get("course") !== null) {
                    $("#submit").hide();
                    let idcourse = searchParams.get("course");
                    $.ajax({
                        type: "GET",
                        url: `http://localhost:8000/course/getOnly/${idcourse}`,
                        success: (data) => {
                            const dataClass = data;

                            $("#title_c").html(`Course name: ${dataClass["title"]}`);
                            $("#desc_c").html(
                                `Description about course: ${dataClass["desc"]}`
                            );

                            const str = `
                <img src="../../../static/${dataClass["img"]}" style="width:100%; height:300px; border-radius:10px;opacity: 0.7;" alt="">
           
                `;
                            $("#show_class").append(str);

                            dataClass["lesson"].forEach((element) => {
                                $.ajax({
                                    url: `http://localhost:8000/lesson/getOnly/${element["idlesson"]}`,
                                    type: "GET",
                                    success: (data) => {
                                        console.log(data);
                                        let str = `
                      <div class="col-3">
                                <div class="card">
                                    <img class="card-img-top" src="../../../static/${data["img"]}" style=" height:200px; " alt="Card image cap">
                                    <div class="card-body">
                                      <h5 class="card-title"> Lesson name:  ${data["title"]}</h5>
                                      <p class="card-text">Description:${data["desc"]}</p>
                                      <small class="text-muted">Created: ${data["create_on"]}</small>
                                    </div>
                                    <div class="card-footer">
                                    <a href="http://localhost:8000/student/detail?lesson=${data["id"]}" class="btn btn-primary">Go to lesson</a>
                                    </div>
                                  </div>
                            </div>
                      
                      
                      `;
                                        $("#course_index").append(str);
                                    },
                                    error: (data) => {
                                        console.error(data);
                                    },
                                });
                            });
                        },
                        error: (data) => {
                            console.log(data);
                        },
                    });
                } else {
                    console.log("null class");
                }
                if (searchParams.get("lesson") !== null) {
                    $('#start').show()
                    $("#course_index").hide();
                    $("#submit").hide();

                    let idlesson = searchParams.get("lesson");
                    $.ajax({
                        type: "GET",
                        url: `http://localhost:8000/lesson/getOnly/${idlesson}`,
                        success: (data) => {
                            const dataClass = data;

                            $("#title_c").html(`Lesson name: ${dataClass["title"]}`);
                            $("#desc_c").html(
                                `Description about lesson: ${dataClass["desc"]}`
                            );

                            const str = `
                <img src="../../../static/${dataClass["img"]}" style="width:100%; height:300px; border-radius:10px;opacity: 0.9;" alt="">
           
                `;
                            $("#show_class").append(str);
                            localStorage.setItem("len", dataClass["quiz"].length);

                            dataClass["quiz"].forEach((element, index) => {
                                $.ajax({
                                    url: `http://localhost:8000/quiz/getOnly/${element["idQuiz"]}`,
                                    type: "GET",
                                    success: (data) => {
                                        localStorage.setItem(
                                            `correct-${index}`,
                                            data["quiz"][0]["Rightanswer"]
                                        );
                                        localStorage.setItem(
                                            `point-${index}`,
                                            data["quiz"][0]["point"]
                                        );
                                        let str = `
                      <div class="col-12">
                        <div class="card">
                        <div class="card-header">
                            Question: ${index + 1} <br>
                            Content: ${data["quiz"][0]["question"]}
                        </div>
                        <div class="card-body">
                            <blockquote class="blockquote mb-0">
                            <form id="input-radio-${index}" >
                                
                                <input type="radio" name="radAnswer-${index}" value="${
                          data["quiz"][0]["answer"][0]
                        }"> ${data["quiz"][0]["answer"][0]}
                                <br>
                                <input type="radio" name="radAnswer-${index}" value="${
                          data["quiz"][0]["answer"][1]
                        }"> ${data["quiz"][0]["answer"][1]}
                                <br>
                                <input type="radio" name="radAnswer-${index}" value="${
                          data["quiz"][0]["answer"][2]
                        }"> ${data["quiz"][0]["answer"][2]}

                                
                                
                            </form>
                            <footer class="blockquote-footer"> point: ${
                              data["quiz"][0]["point"]
                            } </footer>
                            </blockquote>
                        </div>
                        </div>
                            </div>
                      
                      
                      `;
                                        $("#course_index").append(str);
                                    },
                                    error: (data) => {
                                        console.error(data);
                                    },
                                });
                            });
                        },
                        error: (data) => {
                            console.log(data);
                        },
                    });
                } else {
                    console.log("null lesson");
                }

                $("#submit").click(() => {
                    const len = Number(localStorage.getItem("len"));
                    let point = 0;
                    let ans_choose = 0;
                    for (let index = 0; index < len; index++) {
                        var correct = localStorage.getItem(`correct-${index}`);
                        var ans = $(`input[name="radAnswer-${index}"]:checked`).val();
                        $(`#input-radio-${index}`).removeClass("correct");
                        $(`#input-radio-${index}`).removeClass("incorrect");
                        if (correct == ans) {
                            ans_choose += 1;
                            point += Number(localStorage.getItem(`point-${index}`));
                            $(`#input-radio-${index}`).addClass("correct");
                        } else {
                            $(`#input-radio-${index}`).addClass("incorrect");
                        }
                    }
                    obj = {
                        lesson: searchParams.get("lesson"),
                        point: point,
                        correct: ans_choose,
                    };
                    localStorage.setItem("result", JSON.stringify(obj));
                    $.ajax({
                        type: 'POST',
                        url: `http://localhost:8000/result/create`,
                        data: obj,
                        success: (data) => {
                            console.log(data);
                        }

                    })
                    setTimeout(() => {
                        window.location.replace("http://localhost:8000/student/result");
                    }, 2000)
                });
                $("#start").click(() => {
                    $("#course_index").show();
                    $("#submit").show();
                    setInterval(() => {
                        time();
                    }, 1000);
                });
            });
        </script>
        <script>
            let m = 0;
            let ss = 59;

            function time() {
                ss--;
                if (ss == 0) {
                    m -= 1;
                    ss += 59;
                }
                if (m == 0 && ss == 50) {
                    $("#alret").html("Time is running out, back to the homepage");
                }
                if (m == 0 && ss == 1) {
                    window.location.replace("http://localhost:8000/student");
                }

                if (m < 10) {
                    $("#time").html(`Time: 0${m}:${ss}`);
                }
                if (ss < 10) {
                    $("#time").html(`Time: ${m}:0${ss}`);
                }
                if (m < 10 && ss < 10) {
                    $("#time").html(`Time: 0${m}:0${ss}`);
                }
            }
        </script>
        <!-- Last 30 days earnings chart -->
    </body>

    <!-- Mirrored from learnplus.frontendmatter.com/instructor-dashboard.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 09 Jun 2018 08:40:50 GMT -->

    </html>
</body>

</html>